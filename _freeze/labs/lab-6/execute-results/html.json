{
  "hash": "94d40a0734a276b955b8c7eff309f23f",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Lab 6\"\nbibliography: references.bib\n---\n\n\nBy the end of this lab you will create formulate and conduct hypothesis tests using randomization.\n\n## Getting started\n\n1.  Use [these steps](https://sta101-f24.github.io/computing/computing-access.html) to navigate to the STA101 version of `RStudio` using the [Duke Container Manager](https://cmgr.oit.duke.edu/containers);\n\n2.  Use [these steps](https://sta101-f24.github.io/computing/computing-moving.html) to download all of the lab 6 files from our [Canvas page](https://canvas.duke.edu/courses/36641), upload them to your `RStudio` files, and move them into an appropriately named folder (`lab-6`, for instance);\n\n3.  Once `lab-6.qmd` is where it needs to be, open it, and verify that you can click the \"Render\" button in `RStudio` and get a PDF file. See [this answer](https://edstem.org/us/courses/64268/discussion/5216372?answer=12080244) on Ed if you want more guidance here;\n\n4.  Now proceed to complete the exercises in this lab.\n\n## Pointers\n\n-   For all visualizations you create, be sure to include informative titles for the plot, axes, and legend;\n-   Respond in complete sentences as much as possible;\n-   Be sure to observe good code style:\n    -   There is a line break after each `|>` in a pipeline or `+` in a ggplot;\n    -   There are spaces around `=` signs;\n    -   There is a space after each `,`;\n    -   Code is properly indented;\n    -   Code doesn't exceed 80 characters in each line, longer lines of code are spread across multiple lines with appropriately placed line breaks (so in the rendered PDF, your code shouldn't run off the page);\n    -   Code chunks are labeled, informatively and without spaces.\n\n## Packages\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse) \nlibrary(tidymodels)\nlibrary(openintro)\n```\n:::\n\n\n## Part 1: Heart transplants - `outcome`\n\nToday, we will be working with data from The Stanford University Heart Transplant Study [@turnbull1974]:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nheart_transplant <- read_csv(\"data/heart-transplant.csv\")\nglimpse(heart_transplant)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 103\nColumns: 8\n$ id         <dbl> 15, 43, 61, 75, 6, 42, 54, 38, 85, 2, 103, 12, 48, 102, 35,…\n$ outcome    <chr> \"deceased\", \"deceased\", \"deceased\", \"deceased\", \"deceased\",…\n$ transplant <chr> \"control\", \"control\", \"control\", \"control\", \"control\", \"con…\n$ age        <dbl> 53, 43, 52, 52, 54, 36, 47, 41, 47, 51, 39, 53, 56, 40, 43,…\n$ survtime   <dbl> 1, 2, 2, 2, 3, 3, 3, 5, 5, 6, 6, 8, 9, 11, 12, 16, 16, 16, …\n$ acceptyear <dbl> 68, 70, 71, 72, 68, 70, 71, 70, 73, 68, 67, 68, 71, 74, 70,…\n$ prior      <chr> \"no\", \"no\", \"no\", \"no\", \"no\", \"no\", \"no\", \"no\", \"no\", \"no\",…\n$ wait       <dbl> NA, NA, NA, NA, NA, NA, NA, 5, NA, NA, NA, NA, NA, NA, NA, …\n```\n\n\n:::\n:::\n\n\nThe data dictionary is as follows:\n\n| Variable   | Description                                                                                                                                             |\n|-------------------|-----------------------------------------------------|\n| id         | ID number of the patient                                                                                                                                |\n| outcome    | Survival status with levels `alive` and `deceased`                                                                                                      |\n| transplant | Transplant group with levels `control` (did not receive a transplant) and `treatment` (received a transplant)                                           |\n| age        | Age of the patient at the beginning of the study                                                                                                        |\n| survtime   | Number of days patients were alive after the date they were determined to be a candidate for a heart transplant until the termination date of the study |\n| acceptyear | Year of acceptance as a heart transplant candidate                                                                                                      |\n| prior      | Whether or not the patient had prior surgery with levels `yes` and `no`                                                                                 |\n| wait       | Waiting time for transplant                                                                                                                             |\n\n### Exercise 1\n\n::: exercise\nIMS - [Chapter 11 exercises](https://openintro-ims.netlify.app/foundations-randomization#sec-chp11-exercises), #8: Heart transplants.\n:::\n\n### Exercise 2\n\n::: exercise\nRecreate the stacked bar plot in Exercise 1.\n:::\n\n::: callout-tip\n## Hint\n\nThe colors are `#569BBD` and `#114B5F`. Use `scale_fill_manual()` to indicate these are the colors you want to use.\n:::\n\n::: callout-important\n## Pause and render\n\nNow that you've completed a few exercises, pause and render your document. If it renders without any issues, great! Move on to the next exercise. If it does not, debug the issue before moving on. Ask for help from your TA if you need. Do not proceed without rendering your document.\n:::\n\n### Exercise 3\n\n::: exercise\nCalculate the point estimate for the difference in proportions of patients who died between the treatment and control groups: $\\hat{p}_{treatment} - \\hat{p}_{control}$, where $\\hat{p}$ is the observed probability of dying in each group. Do this in two ways:\n\n1.  Construct a frequency table of `outcome` by `transplant` and calculate the difference in proportions \"by hand\".\n2.  Use `specify()` and `calculate()` to calculate the difference in proportions as shown below.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nobs_diff_outcome <- heart_transplant |>\n  specify(response = outcome, explanatory = transplant, success = \"deceased\") |>\n  calculate(stat = \"diff in props\", order = c(\"treatment\", \"control\"))\n```\n:::\n\n\nThen, confirm that you obtained the same results with the two methods.\n:::\n\n### Exercise 4\n\n::: exercise\nUsing the code below, generate a null distribution for the hypothesis test for the hypothesis you formulated in Exercise 1. Use 100 resamples (`reps`). However, change the seed to use a different seed.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(1234)\n\nnull_dist_outcome <- heart_transplant |>\n  specify(response = outcome, explanatory = transplant, success = \"deceased\") |>\n  hypothesize(null = \"independence\") |>\n  generate(reps = 100, type = \"permute\") |>\n  calculate(stat = \"diff in props\", order = c(\"treatment\", \"control\"))\n```\n:::\n\n\nThen, inspect the object `null_dist_outcome` using either `glimpse()` or just printing it to screen. How many rows and how many columns does it have? What does each row represent? What does each variable represent?\n:::\n\n### Exercise 5\n\n::: exercise\nVisualize the distribution of simulated differences in proportions of deceased between treatment and control groups. What is the shape of this distribution? What is the center of this distribution? Are these results expected? Explain your reasoning.\n:::\n\n::: callout-tip\n## Hint\n\nThese simulated values are in the `stat` column of `null_dist_outcome`.\n:::\n\n### Exercise 6\n\n::: exercise\nCalculate the p-value using the `get_p_value` function. Interpret the p-value in context of the data and the research question and comment on the statistical discernibility of this result using a discernibility level of 5%.\n:::\n\n::: callout-important\n## Pause and render\n\nNow that you've completed a few exercises, pause and render your document. If it renders without any issues, great! Move on to the next exercise. If it does not, debug the issue before moving on. Ask for help from your TA if you need. Do not proceed without rendering your document.\n:::\n\n## Part 2: Heart transplants - `survtime`\n\n### Exercise 7\n\n::: exercise\nRecreate the side-by--side box plots in Exercise 1. The variable of interest is `survtime`, which is the number of days patients were alive after the date they were determined to be a candidate for a heart transplant until the termination date of the study.\n:::\n\n### Exercise 8\n\n::: exercise\nDo these data provide convincing evidence of a difference between average survival times of patient who did and did not get a heart transplant?\n\nWrite the hypotheses for answering this question and conduct the hypothesis test using randomization. Use 1,000 resamples. In order to avoid name collision, use object names like `obs_diff_survtime`, `null_dist_survtime`, and `p_value_survtime`. Find and interpret the p-value in context of the data and the research question and comment on the statistical discernability of this result using a discernability level of 5%.\n:::\n\n## Part 3: More IMS Exercises\n\nThe exercises in this section do not require code. Make sure to answer the questions in full sentences.\n\n### Exercise 9\n\n::: exercise\nIMS - [Chapter 11 exercises](https://openintro-ims.netlify.app/foundations-randomization#sec-chp11-exercises), #2: Identify the parameter, II.\n:::\n\n### Exercise 10\n\n::: exercise\nIMS - [Chapter 11 exercises](https://openintro-ims.netlify.app/foundations-randomization#sec-chp11-exercises), #6: Identify hypotheses, II.\n:::\n\n## Lastly\n\nRecommend some music for us to listen to while we grade this.\n\n## Wrap up\n\n### Submitting\n\n::: callout-important\nBefore you proceed, first, make sure that you have updated the document YAML with your name! Then, render your document one last time, for good measure.\n:::\n\nTo submit your assignment to Gradescope:\n\n-   Go to your Files pane and check the box next to the PDF output of your document (`lab-6.pdf`).\n\n-   Then, in the Files pane, go to More \\> Export. This will download the PDF file to your computer. Save it somewhere you can easily locate, e.g., your Downloads folder or your Desktop.\n\n-   Go to the course Canvas page and click on Gradescope and then click on the assignment. You'll be prompted to submit it.\n\n-   Mark the pages associated with each exercise. All of the papers of your lab should be associated with at least one question (i.e., should be \"checked\").\n\n::: callout-warning\nIf you fail to mark the pages associated with an exercise, that exercise won't be graded. This means, if you fail to mark the pages for all exercises, you will receive a 0 on the assignment. The TAs can't mark your pages for you, and for them to be able to grade, you must mark them.\n:::\n\n## Grading\n\n| Exercise    | Points |\n|-------------|--------|\n| Exercise 1  | 6      |\n| Exercise 2  | 4      |\n| Exercise 3  | 4      |\n| Exercise 4  | 6      |\n| Exercise 5  | 5      |\n| Exercise 6  | 4      |\n| Exercise 7  | 5      |\n| Exercise 8  | 7      |\n| Exercise 9  | 5      |\n| Exercise 10 | 4      |\n| **Total**   | 50     |\n",
    "supporting": [
      "lab-6_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}