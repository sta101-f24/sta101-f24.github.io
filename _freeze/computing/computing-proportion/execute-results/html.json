{
  "hash": "f927c6299bf4be4ef5d1c62b7d487200",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Worked example: estimating a single proportion\"\nfig-width: 6\nfig-asp: 0.618\n---\n\n\n## Packages\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(tidymodels)\n```\n:::\n\n\n## Data\n\nIn a [survey conducted by Survey USA](https://www.surveyusa.com/client/PollReport.aspx?g=4d09191d-b0b5-42cd-91c8-bd1bdf587199) between September 30, 2023 and October 3, 2023, 2759 registered voters from all 50 US states were asked\n\n> America will hold an election for President of the United States next November. Not everyone makes the time to vote in every election. Which best describes you? Are you certain to vote? Will you probably vote? Are the chances you will vote about 50/50? Or will you probably not vote?\n\nThe data from this survey can be found in `voting-survey.csv`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvoting_survey <- read_csv(\"voting-survey.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 2759 Columns: 2\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (1): vote\ndbl (1): id\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code}\nglimpse(voting_survey)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 2,759\nColumns: 2\n$ id   <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19…\n$ vote <chr> \"Certain to vote\", \"Certain to vote\", \"Certain to vote\", \"Certain…\n```\n\n\n:::\n:::\n\n\n## Visualize and summarize the data\n\nThis simple bar plot displays the number of respondents who gave each of the five possible answers:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(voting_survey, aes(y = vote)) + \n  geom_bar()\n```\n\n::: {.cell-output-display}\n![](computing-proportion_files/figure-html/bar-plot-1.png){width=576}\n:::\n:::\n\n\nThis code calculates the proportion of respondents that gave each answer:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvoting_survey |>\n  count(vote) |>\n  mutate(props = n / sum(n))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 5 × 3\n  vote                       n  props\n  <chr>                  <int>  <dbl>\n1 About 50/50 chance       293 0.106 \n2 Certain to vote         1921 0.696 \n3 Not sure                  44 0.0159\n4 Probably will not vote    92 0.0333\n5 Will probably vote       409 0.148 \n```\n\n\n:::\n:::\n\n\n## Interval estimation\n\nBased on these data, we want to estimate the true proportion of registered US voters who are certain to vote in the next presidential election. Our point estimate based on the survey responses is 69.6%, but how reliably estimated is that? To answer this, we need to construct a confidence interval.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Prepare the data for analysis (pre-processing)\n\nvoting_survey <- voting_survey |>\n  mutate(vote = if_else(vote == \"Certain to vote\", \"Certain to vote\", \"Not certain to vote\"))\n\nset.seed(20)\n\nboot_dist <- voting_survey |>\n  specify(response = vote, success = \"Certain to vote\") |>\n  generate(reps = 1000, type = \"bootstrap\") |>\n  calculate(stat = \"prop\")\n\nci <- boot_dist |>\n  get_ci()\nci\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 2\n  lower_ci upper_ci\n     <dbl>    <dbl>\n1    0.679    0.714\n```\n\n\n:::\n\n```{.r .cell-code}\nvisualize(boot_dist) + \n  shade_ci(ci)\n```\n\n::: {.cell-output-display}\n![](computing-proportion_files/figure-html/bootstrap-ci-1.png){width=576}\n:::\n:::\n\n\n## Hypothesis testing\n\nPew says that 66% of eligible US voters turned out for the 2020 presidential election. A newspaper claims that even more people will turnout in 2024, and cites this survey as evidence. Do these data provide convincing evidence for this claim?\n\nThe formal hypotheses are \n\n$$\n\\begin{aligned}\n\\text{H}_0: p&=0.66\\\\\n\\text{H}_A: p&>0.66,\n\\end{aligned}\n$$\nwhere $p$ is the true proportion that say they are guaranteed to turn out in 2024. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# compute the observed proportion\n\nobs_stat <- voting_survey |>\n    specify(response = vote, success = \"Certain to vote\") |>\n    calculate(stat = \"prop\")\n\n# simulate the null distribution\n\nset.seed(525600)\n\nnull_dist <- voting_survey |>\n  specify(response = vote, success = \"Certain to vote\") |>\n  hypothesize(null = \"point\", p = 0.66) |>\n  generate(reps = 1000, type = \"draw\") |>\n  calculate(stat = \"prop\")\n\n# visualize and compute the p-value\n\nnull_dist |>\n  visualize() +\n  shade_p_value(obs_stat = obs_stat, direction = \"greater\")\n```\n\n::: {.cell-output-display}\n![](computing-proportion_files/figure-html/randomization-test-1.png){width=576}\n:::\n\n```{.r .cell-code}\nnull_dist |>\n  get_p_value(obs_stat, direction = \"greater\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Please be cautious in reporting a p-value of 0. This result is an approximation\nbased on the number of `reps` chosen in the `generate()` step.\nℹ See `get_p_value()` (`?infer::get_p_value()`) for more information.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 1\n  p_value\n    <dbl>\n1       0\n```\n\n\n:::\n:::\n\nOur p-value is approximately zero, which is below every standard discernibility level, and therefore we reject the null. The interpretation is:\n\n> If the null were true and there were just as many certain voters in 2023 as in 2020, then there is a 0% chance we would get an estimate as or more extreme (greater) than the one we actually got. As such, the null is probably a bunch of balderdash.",
    "supporting": [
      "computing-proportion_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}